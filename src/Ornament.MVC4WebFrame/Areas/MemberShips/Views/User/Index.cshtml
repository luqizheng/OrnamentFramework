@using Ornament
@using Ornament.MVCWebFrame.Models
@using Ornament.MVCWebFrame.Models.Membership
@using Ornament.MemberShip
@using Ornament.MemberShip.Dao
@using Ornament.Models.Memberships
@using Ornament.Web
@using Ornament.Web.Bundles
@using Resources
@using Ornament.Web.HtmlExtends;
@model IEnumerable<Ornament.MemberShip.User>
@{
    ViewBag.Title = MemberShip.User;
    Layout = OrnamentContext.Configuration.BackendLayout();
    bool editPermission = OrnamentContext.MemberShip.HasRight(ResourceSetting.User, UserOperator.Modify);
    var status = ViewData["UserStatus"] as UsersStatusModel;
}

@section scripts 
{
    @Html.Partial("_pm")

    <script type="text/javascript">

        seajs.use("@ScriptsSeajs.RenderUrl("~/Scripts/Modules/Views/Memberships/user/index.js")", function (main) {
            main.init({
                success: "@Html.GetResourceString("verify_email_success")",
                fail: "@Html.GetResourceString("verify_email_fail")"
            }, {
                success: "@Html.GetResourceString("retrieve_pwd_success")",
                fail: "@Html.GetResourceString("retrieve_pwd_fail")"
            }, {
                Id: "@OrnamentContext.MemberShip.CurrentUser().Id",
                Name: "@OrnamentContext.MemberShip.CurrentUser().Name"
            }, {
                url: "@Url.Action("Users", "User", new { area = "MemberShips" })"
                });
        });
    </script>
}

@section pageTitle{
    <h5>MemberShip Dashboard</h5>
}
<div class="actions-wrapper">
    <div class="actions">
        <div id="user-stats">
            <ul class="round-buttons">
                @if (OrnamentContext.MemberShip.HasRight("User", UserOperator.Modify))
                {
                    <li>
                        <div class="depth"><a href="@Url.Action("Create", "User", new { area = "MemberShips" })" title="@Html.GetResourceString("quickAction_CreateUser")" class="tip"><i class="icon-plus"></i></a></div>
                    </li>
                }
            </ul>
        </div>
        <div id="quick-actions">
            <ul class="statistics">
                <li>
                    <div class="top-info">
                        <a href="#" title="" class="sea-square"><i class=" icon-globe"></i></a>
                        <strong>@status.OnlineUser</strong>
                    </div>
                    <div class="progress progress-micro">

                        <div class="bar" style="width: @status.OnlineUserRate.ToString("P");"></div>
                    </div>
                    <span class="tip" title="@status.OnlineUser/@status.TotalUsers ">@Html.GetResourceString("OnlineUser")</span>
                </li>
                <li>
                    <div class="top-info">
                        <a href="#" title="" class="blue-square"><i class="icon-plus"></i></a>
                        <strong>@status.TodayRegist</strong>
                    </div>
                    <div class="progress progress-micro">
                        <div class="bar" style="width: @(status.TodayRegistRate.ToString("P"))"></div>
                    </div>
                    <span class="tip" title="@status.TodayRegist/@status.TotalUsers">@Html.GetResourceString("TodayRegist")</span>
                </li>
            </ul>
        </div>
        <ul class="action-tabs">
            <li><a href="#user-stats" title="">@Html.GetResourceString("QuickActions")</a></li>
            <li><a href="#quick-actions" title="">@Html.GetResourceString("QuickActions_MemberState")</a></li>
        </ul>
    </div>
</div>

<form action="@Url.Action("Index")" class="search widget"method="POST">
    <div class="autocomplete-append">
        <input type="text" id="searchContent" name="search" placeholder="@String.Format(Html.GetResourceString("search_placeHolder"), @Basic.Email, @Basic.Phone)" 
               class="ui-autocomplete-input" autocomplete="off">
        <span role="status" aria-live="polite" class="ui-helper-hidden-accessible"></span>
        <input type="submit" value="@Basic.Search" class="btn btn-info">
    </div>
</form>



<ul class="options-bar">
    <li>
        <form>
            <div class="bulk">
                <div class="bar-select">
                    <span>@Html.GetResourceString("ApplyAction")</span>

                    <select id="selApplyAction">
                        @if (OrnamentContext.MemberShip.HasRight("User", UserOperator.Lock))
                        {
                            <option value="Lock">@Html.GetResourceString("Lock")</option>
                            <option value="unLock">@Html.GetResourceString("Unlock")</option>
                        }

                        @if (OrnamentContext.MemberShip.HasRight("User", UserOperator.Approve))
                        {
                            <option value="Approve">@Html.GetResourceString("Approve")</option>
                        }
                        @if (OrnamentContext.MemberShip.HasRight("User", UserOperator.Delete))
                        {
                            <option value="delete">
                                @Basic.Delete
                            </option>
                        }
                    </select>

                </div>

                <div class="bar-button">
                    <button class="btn btn-info" type="button" id="BtnApply" disabled="disabled">@Html.GetResourceString("BtnApply")</button>
                </div>
            </div>
        </form>
    </li>
</ul>

@using (Html.Box())
{
    <form method="POST" id="tableForm">
        <table class="table table-condensed table-striped table-bordered table-checks" id="table">
            <thead>
                <tr>
                    <th></th>
                    <th class="span1"></th>
                    <th class="span1">
                        @Html.DisplayNameFor(model => model.LoginId)
                    </th>

                    <th style="width: 100px">
                        @Html.DisplayNameFor(model => model.Name)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Contact.Email)
                    </th>
                    <th>
                        @Html.LabelFor(item => ((User)null).IsLockout)
                    </th>
                    <th>
                        @Html.LabelFor(item => ((User)null).IsApproved)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Other.LastActivityDate)
                    </th>
                </tr>
            </thead>
           
        </table>
    </form>
}