@using Ornament.MemberShip
@using Qi.Web
@model Ornament.MemberShip.UserGroup[]
@{
    string display = ViewData.ModelMetadata.DisplayName ?? ViewData.ModelMetadata.PropertyName;
    UserGroup[] ugs = Model ?? new UserGroup[0];
    var selected = from a in ugs
                   select new
                       {
                           id = a.Id,
                           text = a.Name
                       };
}
<div class="control-group">
    @Html.Label("", display, new {@class = "control-label"})
    <div class="controls">
        @Html.Hidden("", String.Join(",", from role in ugs select role.Id), new {style = "width:100%",role="usergroup.select2"})
    </div>

    <script type="text/javascript">
        seajs.use("membership", function(r){
            var d = @Html.Raw(JsonHelper.ToJson(selected));
            r.select2.userGroup("#@Html.Id("")", d);
        });
    </script>
</div>
