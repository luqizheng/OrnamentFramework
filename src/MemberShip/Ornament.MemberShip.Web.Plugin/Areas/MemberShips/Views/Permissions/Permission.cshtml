@using Ornament
@using Ornament.Web
@using Ornament.Web.UI.Theme
@using Qi.Web
@model Ornament.MemberShip.Permissions.Permission
@{
    ViewBag.Title = "Permission";
    Layout = OrnamentContext.Configuration.Layout();
    object jsonObject = null;
    if (Model != null)
    {
        jsonObject = new
        {
            Model.Id,
            Model.Name,
            Model.Remark,
            Model.Operator
        };
    }
}
@section pageTitle{
    <h5>Permission</h5>
}

@using (Panel panel = Html.Panel())
{
    @panel.Header(@<text>
    Edit Permissions
                   </text>)
    @panel.Body(@<text><div class="row">
        <form id="wizard2" method="post" action="@Url.Action("Save")">
            <div id="bootstrap-wizard-1" class="col-sm-12">
                <div class="form-bootstrapWizard">
                    <ul class="bootstrapWizard form-wizard">
                        <li class="active" data-target="#step1">
                            <a href="#tab1" data-toggle="tab"><span class="step">1</span> <span class="title">选择资源类别</span> </a>
                        </li>
                        <li data-target="#step2">
                            <a href="#tab2" data-toggle="tab"><span class="step">2</span> <span class="title">选择你要对应资源</span> </a>
                        </li>
                        <li data-target="#step3">
                            <a href="#tab3" data-toggle="tab"><span class="step">3</span> <span class="title">设置许可证基础信息</span> </a>
                        </li>
                        <li data-target="#step4">
                            <a href="#tab4" data-toggle="tab"><span class="step">4</span> <span class="title">Save Form</span> </a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="tab-content">
                    <div class="tab-pane active" id="tab1">
                        <br>
                        <h3><strong>Step 1 </strong>- 选择资源类型</h3>
                        <div class="row">
                            <div class="col-sm-12">
                                @{
                                    int i = -1;
                                    foreach (ResourceDescription resourceDescription in OrnamentContext.ResourceManager.Configuration().ResourceSettings)
                                    {
                                        bool foundSelected = i == -1 || (Model != null && resourceDescription.ValueType == Model.Resource.GetType());
                                        i++;

                                    <div class="form-group">
                                        <label for="@("ResourceType" + i)">
                                            @Html.RadioButton("DescriptionResourceName", resourceDescription.Name, foundSelected, new { id = "ResourceType" + i })
                                            @resourceDescription.Name
                                        </label>
                                    </div>
                                    }
                                }
                            </div>
                        </div>
                        <br />
                        <br />
                    </div>

                    <div class="tab-pane" id="tab2">
                        <br>
                        <h3><strong>Step 2 </strong>- 选择资源</h3>
                        <div id="resViewContent" class="row">
                        </div>
                    </div>

                    <div class="tab-pane" id="tab3">
                        <br>
                        <h3><strong>Step 3 </strong>- 基本信息</h3>
                        <div id="editPermissionView" class="form-horizontal">
                            <div class="form-group">
                                @Html.LabelFor(s => s.Name, new { @class = "col-md-2" })
                                @Html.TextBoxFor(s => s.Name, new { @class = "col-md-8" +
                                                                             "" })
                                @Html.ValidationMessageFor(s => s.Name)

                            </div>
                            <div class="form-group">
                                @Html.LabelFor(s => s.Remark, new { @class = "col-md-2" })
                                @Html.TextAreaFor(s => s.Remark, new { @class = "col-md-8" })
                                @Html.ValidationMessageFor(s => s.Remark)
                            </div>
                            <div class="form-group">
                                <label class="col-md-2">
                                    @Html.GetEmbededResourceString("Operators")
                                </label>
                                <div id="operators" class="col-md-8">
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="tab-pane" id="tab4">
                        <br />
                        <h3><strong>Complete</strong>, click next for submit.</h3>
                    </div>

                    <div class="form-actions">
                        <div class="row">
                            <div class="col-sm-12">
                                <ul class="pager wizard no-margin">

                                    <li class="previous disabled">
                                        <a href="javascript:void(0);" class="btn btn-lg btn-default">Previous </a>
                                    </li>

                                    <li class="next">
                                        <a href="javascript:void(0);" class="btn btn-lg txt-color-darken">Next </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            @Html.Hidden("operators", Model != null ? Model.Operator : 0)
            @Html.HiddenFor(s => s.Id)
        </form>
    </div>
    </text>)
}


@section scripts
{
    <script type="text/javascript">
        require(["@Scripts.Url("/memberships/scripts/permissions/permission.js")"], function (main) {

            main(@(jsonObject != null ? Html.Raw(JsonHelper.ToJson(jsonObject)) : new MvcHtmlString("null")));

        });
    </script>

}