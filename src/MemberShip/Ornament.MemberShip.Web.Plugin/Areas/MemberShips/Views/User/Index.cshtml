@using Ornament
@using Ornament.MemberShip.Plugin.Areas.MemberShips.Models
@using Ornament.MemberShip.Plugin.Models
@using Ornament.Properties
@using Ornament.Web
@using Ornament.Web.UI.Theme
@model IEnumerable<Ornament.MemberShip.User>
@{
    ViewBag.Title = Html.GetEmbededResourceString("page_title");
    Layout = OrnamentContext.Configuration.Layout();
    bool editPermission = OrnamentContext.MemberShip.HasRight(ResourceSetting.User, UserOperator.Modify);
}


@section scripts 
{
    <script type="text/javascript">
        require(['@Scripts.Url("~/MemberShips/Scripts/User/Index.js")'], function (main) {
            var multiLanguate = {
                verifyEmailMessage: {
                    success: '@Html.GetEmbededResourceString("verify_email_success")',
                    fail: '@Html.GetEmbededResourceString("verify_email_fail")'
                },
                retrievePwdMessage: {
                    success: '@Html.GetEmbededResourceString("retrieve_pwd_success")',
                    fail: '@Html.GetEmbededResourceString("retrieve_pwd_fail")'
                }
            };

            main.init(multiLanguate);
        });
    </script>}

  <section id="widget-grid">
    <!-- row -->
    <div class="row">
    <!-- SINGLE GRID -->
        <article class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
            <div class="jarviswidget" id="wid-id-0">
                <header>
                    <h2>User Lists</h2>
                </header>
                <div class="widget-body">
                    <table class="table table-condensed table-striped" ms-controller="index">
                     <thead>
                         <tr>
                             <td colspan="8">
                                 <form class="form-search" ms-on-submit="search">
                                     <input type="text" ms-duplex="content" 
                                         placeholder="@Html.DisplayNameFor(model => model.LoginId),@Html.DisplayNameFor(model => model.Name),@Html.DisplayNameFor(model => model.Contact.Email) "/>
                                     <button class="btn btn-primary">@Resources.Search</button>
                                 </form>
                             </td>
                         </tr>
                         <tr>
                             <th></th>
                             <th>
                                 @Html.DisplayNameFor(model => model.LoginId)
                             </th>
                             <th>
                                 @Html.DisplayNameFor(model => model.Name)
                             </th>
                             <th>
                                 @Html.DisplayNameFor(model => model.Contact.Email)
                             </th>
                             <th>
                                 @Html.DisplayNameFor(model => model.Contact.Phone)
                             </th>
                             <th>
                                 @Html.DisplayNameFor(model => model.IsDeny)
                             </th>
                             <th>
                                 @Html.DisplayNameFor(model => model.Security.IsLocked)
                             </th>
                             @* <th>
                        @Html.DisplayNameFor(model => model.IsApproved)
                    </th>*@
                             <th>
                                 @Html.DisplayNameFor(model => model.Other.LastActivityDate)
                             </th>
                         </tr>
                     </thead>

                     <tbody ms-if="users.length!=0">
                         <tr ms-repeat-el="users"
                             ms-attr-data="{{el.Id}}"
                             ms-attr-loginid="{{el.LoginId}}">
                             <td>
                                 <a ms-href="/MemberShips/User/Edit/{{el.LoginId}}" class="btn btn-default btn-xs"><i class="fa fa-edit"></i></a>
                             </td>
                             <td ms-text="el.LoginId"></td>
                             <td ms-text="el.Name"></td>
                             <td>
                                 
                                 <span ms-text="el.Email"></span>
                                 <a class="btn btn-default btn-xs" ms-if="el.EmailVerified==false && el.Email!='' && el.Email!=null" ms-click="verifyEmail"
                                    title="@Ornament.MemberShip.Web.Plugin.Properties.Resources.VerifyEmail">
                                     <i class="fa  fa-flag-o"></i>
                                     @Html.GetEmbededResourceString("Verify")
                                 </a>
                             </td>
                             <td ms-text="el.Phone"></td>
                             <td>
                                 <div class="btn-group">
                                     <a class="btn btn-default btn-xs" ms-click="deny">
                                         <i class="fa" ms-class="fa-times:el.Deny" ms-class-1="fa-check:el.Deny==false"></i>
                                     </a>
                                     <a class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" href="#">
                                         <i class="caret"></i>
                                     </a>
                                     <ul class="dropdown-menu">
                                         <li><a href="#" ms-click="deny(true)"><i class="fa fa-remove"></i>@Html.GetEmbededResourceString("Deny")</a></li>
                                         <li><a href="#" ms-click="deny(false)"><i class="fa fa-ok"></i>@Html.GetEmbededResourceString("Allow")</a></li>
                                     </ul>
                                 </div>
                             </td>
                             <td>
                                 <div class="btn-group">
                                     <a class="btn btn-default btn-xs" ms-click="lock">
                                         <i class="fa" ms-class="fa-lock:el.IsLocked" ms-class-1="fa-unlock:!el.IsLocked"></i>
                                     </a>
                                     <a class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" href="#">
                                         <i class="caret"></i>
                                     </a>
                                     <ul class="dropdown-menu">
                                         <li><a href="#" ms-click="lock(true)"><i class="fa fa-lock"></i>@Html.GetEmbededResourceString("Lock")</a></li>
                                         <li><a href="#" ms-click="lock(false)"><i class="fa fa-unlock"></i>@Html.GetEmbededResourceString("Unlock")</a></li>
                                     </ul>
                                 </div>
                             </td>
                             @*<td>
                        <div class="btn-group">
                            <a class="btn btn-primary btn-mini" ms-click="switchApprove">
                                <i ms-class="icon-ok:el.IsApproved" ms-class-1="icon-remove:!el.IsApproved"></i>
                            </a>
                            <a class="btn btn-primary btn-mini dropdown-toggle" data-toggle="dropdown" href="#">
                                <i class="icon-caret-down icon-white"></i>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="#" ms-click="approve(true)"><i class="icon-ok"></i>@Html.GetEmbededResourceString("Approve")</a></li>
                                <li><a href="#" ms-click="approve(false)"><i class="icon-remove"></i>@Html.GetEmbededResourceString("VerifyAgain")</a></li>
                            </ul>
                        </div>
                    </td>*@
                             <td ms-text="el.LastActivityDate"></td>
                         </tr>
                     </tbody>
                     <tbody ms-if="users.length==0">
                         <tr>
                             <td colspan="8">@Html.GetEmbededResourceString("Not_User_Found")</td>
                         </tr>
                     </tbody>
                     <tfoot>
                         <tr>
                             <td colspan="8" ms-widget="pagination,$,$pageOpts" ms-include-src="/Scripts/avalons/Pagination/Pagination.html"></td>
                         </tr>
                     </tfoot>
                 </table>
                </div>
            </div>
        </article><!-- GRID END -->
    </div><!-- end row -->
  </section>
    
